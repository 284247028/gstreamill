

    <div class="container-fluid">
        <div class="row jobstatus_content">
                <div id='jobstatus_content'></div>
        </div>
    </div>


    <script type="text/javascript">

    function status_append_item (body, key, value) {
        var key_ele = document.createElement ("div"),
            value_ele = document.createElement ("div");
        key_ele.setAttribute ("class", "col-lg-4");
        key_ele.innerHTML = "<label class=\"pull-right jobmanage\" data-i18n=\"jobmanage." + key + "\"></label>";
        value_ele.setAttribute ("class", "col-lg-7");
        value_ele.innerHTML = "<p>" + value + "</p>";
        body.appendChild (key_ele);
        body.appendChild (value_ele);
    }

    function status (name) {
        var name = location.href.replace (/[^\?]*\?name=(.*)/, "$1");
        $.get("/stat/gstreamill/job/" + name, function (data) {
            if (data.result === 'failure') {
                bootbox.alert ($.t ("jobmanage.Get Job Stat Failure"));
                return;
            }

            var job_stat_element = document.createElement ("div"),
                job_stat_header = document.createElement ("div"),
                job_stat_body = document.createElement ("div");

            job_stat_element.setAttribute ("class", "panel panel-primary");
            job_stat_element.setAttribute ("id", "jobstatus");
            job_stat_header.setAttribute ("class", "panel-heading jobmanage");
            job_stat_header.setAttribute ("data-i18n", "jobmanage.Job Status");
            job_stat_element.appendChild (job_stat_header);

            job_stat_body.setAttribute ("class", "panel-body");

            /* job status */
            status_append_item (job_stat_body, "Restart Times", data.data.age);
            status_append_item (job_stat_body, "Last Restart Time", data.data.last_start_time);
            status_append_item (job_stat_body, "Current Concurrent Count", data.data.current_access);
            status_append_item (job_stat_body, "Average CPU Usage", data.data.cpu_average);
            status_append_item (job_stat_body, "Current CPU Usage", data.data.cpu_current);
            status_append_item (job_stat_body, "Memory Usage", data.data.memory);

            /* source status */
            var source_title = document.createElement ("h3"),
                source_stat = document.createElement ("div");
            source_title.innerHTML = "Source";
            source_stat.setAttribute ("class", "well row pipeline-stat");
            var streams_table = "<span class=\"jobmanage\" data-i18n=\"jobmanage.Sync Error Times\"></span>: " +
                                    data.data.source.sync_error_times +
                                    "; <span class=\"jobmanage\" data-i18n=\"jobmanage.Streams Count\"></span>: " +
                                    data.data.source.stream_count +
                                    "<table class=\"table\">" +
                                    "<tr>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Name\"></th>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Last Time Stamps\"></th>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Last Heartbeat Time\"></th>" +
                                    "</tr>";
            for (var i = 0; i < data.data.source.streams.length; i++) {
                var stream = data.data.source.streams[i];
                var tr = "<tr>" +
                         "<td>" + stream.name + "</td>" +
                         "<td>" + stream.timestamp + "</td>" +
                         "<td>" + stream.heartbeat + "</td>" +
                         "</tr>";
                streams_table += tr;
            }
            streams_table += "</table>";
            source_stat.innerHTML = streams_table;

            job_stat_body.appendChild (source_title);
            job_stat_body.appendChild (source_stat);

            /* encoders status */
            for (var i = 0; i < data.data.encoders.length; i++) {
                var encoder_title = document.createElement ("h3"),
                    encoder_stat = document.createElement ("div"),
                    encoder = data.data.encoders[i];
                encoder_title.innerHTML = encoder.name;
                encoder_stat.setAttribute ("class", "well row pipeline-stat");
                var streams_table = "<span class=\"jobmanage\" data-i18n=\"jobmanage.Output Heartbeat\"></span>: " +
                                    encoder.heartbeat +
                                    "; <span class=\"jobmanage\" data-i18n=\"jobmanage.Total Output Bytes\"></span>: " +
                                    encoder.count +
                                    "; <span class=\"jobmanage\" data-i18n=\"jobmanage.Streams Count\"></span>: " +
                                    encoder.streamcount +
                                    "<table class=\"table\">" +
                                    "<tr>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Name\"></th>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Last Time Stamps\"></th>" +
                                    "<th class=\"jobmanage\" data-i18n=\"jobmanage.Last Heartbeat Time\"></th>" +
                                    "</tr>";
                for (var j = 0; j < encoder.streams.length; j++) {
                    var stream = encoder.streams[j];
                    var tr = "<tr>" +
                             "<td>" + stream.name + "</td>" +
                             "<td>" + stream.timestamp + "</td>" +
                             "<td>" + stream.heartbeat + "</td>" +
                             "</tr>";
                    streams_table += tr;
                }
                encoder_stat.innerHTML = streams_table;

                job_stat_body.appendChild (encoder_title);
                job_stat_body.appendChild (encoder_stat);
            }

            job_stat_element.appendChild (job_stat_body);
            $("#jobstatus_content").html (job_stat_element);
            $(".jobmanage").i18n ();
        });
    }

    $ (document).ready (function () {
        $.get("/admin/getconf", function (data) {
            if (data.result == "success") {
                Document.GstreamillConf.conf = data.data;
            } else {
                bootbox.alert ("Get Configure Failure: " + data.reason);
                return;
            }

            $.i18n.init({
                lng: Document.GstreamillConf.language[Document.GstreamillConf.conf.language]
            }, function(t) {
                $(".nav").i18n ();
                $(".jobmanage").i18n ();
            });

            status ();
        });

    });

    </script>
