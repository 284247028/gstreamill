
    <div class="container-fluid">
        <ul class="list-group" id="joblist">
    </div>


    <script type="text/javascript">

    function showJobStatus (response) {
        var li = '<div class="row">';
        li += '<div class="col-md-10">';
        li += '<a href="/admin/jobmanage.html?name=';
        if (response.result == "success") {
            var job = response.data;
            li += job.name + '"><h3>' + job.name + '</h3></a>';
            li += ' Restart ' + job.age + ' times,';
            li += ' Last time started at ' + job.last_start_time;
            li += '</div>';
            li += '<div class="col-md-2">';
            li += '<button class="btn btn-warning" id="job_' + job.name + '" onclick="stopJob(\'' + job.name + '\')">Stop Job</button>';
            li += '</div>';
            li += '</div>';
            li += '<div class="row">';
            li += '<div class="col-md-12">';
            li += '<h4>encoder counts: </h4>' + job.encoder_count;
            li += ' <h4>Average CPU usage: </h4>' + job.cpu_average;
            li += ' <h4>Memory usage: </h4>' + job.memory;
            li += '</div></div>';
            $('#li_' + job.name).html(li);
        } else {
            var job = response;
            li += job.name + '"><h3>' + job.name + '</h3></a>';
            li += ' The job is not started.';
            li += '</div>';
            li += '<div class="col-md-2">';
            li += '<button class="btn btn-primary" id="job_' + job.name + '" onclick="startJob(\'' + job.name + '\')">Start Job</button>';
            li += '</div></div>';
            $('#li_' + job.name).html(li);
        }
    }

    function startJob (name) {

        $.get ("/admin/getjob/" + name, function (data) {

            if (data.result == "failure") {
                alert (data.reason);
                return;
            }

            var job = JSON.stringify (data.data, null, 4);

            $.post ("/admin/start", job, function (response) {
                if (response.result == "success") {
                    alert ('start ' + name + ' ' + response.result);
                    var jobStatUrl = '/stat/gstreamill/job/' + response.name;
                    var jobStat = $.get(jobStatUrl, function (response) {
                        showJobStatus (response);
                    });

                } else {
                    alert (response.result + "\n" + response.reason);
                }
            });

        });

    }

    function stopJob (name) {

        $.get ("/admin/stop/" + name, function (response) {
            if (response.result == "success") {
                alert ('stop ' + response.name + ' ' + response.result);
                var jobStatUrl = '/stat/gstreamill/job/' + response.name;
                var jobStat = $.get(jobStatUrl, function (response) {
                    showJobStatus (response);
                });

            } else {
                alert (response.result + "\n" + response.reason);
            }
        });

    }

    $(document).ready(function () {

        $.get("/admin/listjob", function (jobs) {
            for (var i = 0; i < jobs.length; i++) {
                var li = '<li class="list-group-item" id="li_' + jobs[i] + '"></li>';
                $('#joblist').append(li);
                var jobStatUrl = '/stat/gstreamill/job/' + jobs[i];
                var jobStat = $.get(jobStatUrl, function (response) {
                    showJobStatus (response);
                });
            }
        });

    });

    </script>
